<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" href="/lib/revealjs/reveal.css" />
    <link rel="stylesheet" href="/lib/revealjs/theme/moon.css" />
    <link rel="stylesheet" href="/lib/revealjs/plugins/highlight/zenburn.css" />
    <link rel="stylesheet" href="/assets/styles/default.css" />

    <script src="/socket.io/socket.io.js" lang="javascript"></script>
    <script src="/lib/revealjs/reveal.js" lang="javascript"></script>
    <script src="/lib/revealjs/plugins/highlight/highlight.js" lang="javascript"></script>
    <script src="/lib/revealjs/plugins/markdown/markdown.js" lang="javascript"></script>
    <script src="/lib/revealjs/plugins/mermaid/mermaid.js" lang="javascript"></script>
    <script src="/lib/revealjs/plugins/notes/notes.js" lang="javascript"></script>
    <script src="/assets/scripts/index.js" lang="javascript"></script>

    <title>Intro to MongoDB</title>
</head>

<body>
    <div class="reveal">
        <div class="slides">
            <section>
                <div class="title-slide">
                    <div class="hero-image">
                        <img src="./assets/images/title.jpg">
                    </div>

                    <div class="title-content">
                        <h2 class="fragment semi-fade-out">Intro to MongoDB</h2>
                        <h4 class="fragment fade-down">Things I wish I knew 5 years ago</h4>

                        <p style="font-size: 0.5em">
                            Dave Fancher<br />
                            Lead Software Engineer<br />
                            Vibenomics, A Mood Media Company
                        </p>
                        <hr />
                        <p style="font-size: 0.5em; margin-bottom: 1.5em;">
                            Twitter: @davefancher<br />
                            LinkedIn: davefancher
                        </p>
                    </div>
                </div>

                <div class="footnote">Base cover image generated by Microsoft Bing search chat;
                    Edited in Affinity Photo 2</div>
            </section>

            <section>
                <h2>About this Presentation</h2>
                <ul>
                    <li class="fragment">Not intended to be comprehensive</li>
                    <li class="fragment">Discussion of useful MongoDB concepts</li>
                    <li class="fragment">Focusing on the database, not Atlas</li>
                    <li class="fragment">Sticking as close to <code class="javascript">mongosh</code> as possible</li>
                    <li class="fragment">Examples use the Sample Mflix Dataset provided by MongoDB unless otherwise stated</li>
                </ul>
            </section>

            <section>
                <section>
                    <h2>What is MongoDB?</h2>

                    <ul>
                        <li class="fragment">NoSQL database</li>
                        <li class="fragment">Broad support across most ecosystems</li>
                        <li class="fragment">
                            <span class="fragment strike semi-fade-out">Tables & Rows</span>
                            <span class="fragment fade-in">Collections & Documents</span>
                        </li>
                        <li class="fragment">
                            <span class="fragment strike semi-fade-out">Schemaless</span>
                            <span class="fragment fade-in">Flexible schema</span>
                        </li>
                        <li class="fragment">
                            <span class="fragment strike semi-fade-out">Non-relational</span>
                            <span class="fragment fade-in">All data is relational</span>
                        </li>
                    </ul>
                </section>

                <section>
                    <h3>NoSQL Database</h3>

                    <ul>
                        <li class="fragment">Doesn't use SQL</li>
                        <li class="fragment">MongoDB Query Language (MQL)</li>
                        <li class="fragment">JSON-like language</li>
                        <li class="fragment">Defines standard CRUD operations</li>
                        <li class="fragment">Defines schema manipulation operations</li>
                        <li class="fragment">Aggregation pipelines</li>
                    </ul>
                </section>

                <section>
                    <h3>MQL Example - findOne</h3>

                    <div class="two-column-code">
                        <div class="example">
                            <pre>
                                <code class="javascript" data-trim data-noescape data-line-numbers="1-16|1|3-4|5-16|6|7-16">
                                    use('sample_mflix');
        
                                    db
                                        .getCollection("movies")
                                        .findOne(
                                            { title: /What we do in the shadows/i },
                                            {
                                                _id: 1,
                                                title: 1,
                                                rated: 1,
                                                languages: 1,
                                                directors: 1,
                                                cast: 1,
                                                genres: 1,
                                                imdb: 1,
                                            });
                                </code>
                            </pre>
                        </div>

                        <div class="output">
                            <pre>
                                <code id="mqlExampleOutput" class="json" data-trim data-noescape>
                                </code>
                            </pre>
                        </div>

                        <div class="fragment fade-in example-controls">
                            <button id="clearMqlExampleButton">Clear</button>
                            <button id="runMqlExampleButton">Run</button>
                        </div>
                    </div>
                </section>

                <section>
                    <h3>Broad Availability</h3>

                    <div class="two-column-text">
                        <div class="fragment">
                            <p>Native Drivers</p>
                            <ul class="fragment">
                                <li>Node.js</li>
                                <li>.NET</li>
                                <li>C++</li>
                                <li>Go</li>
                                <li>Java</li>
                                <li>Python</li>
                                <li>Rust</li>
                                <li>...</li>
                            </ul>
                        </div>

                        <div>
                            <p class="fragment">Hosting</p>
                            <ul class="fragment">
                                <li>Self (Install or Docker)</li>
                                <li>Atlas</li>
                            </ul>

                            <p class="fragment">1st Party Tools</p>
                            <ul class="fragment">
                                <li>Atlas</li>
                                <li>Compass</li>
                                <li>VS Code Extension</li>
                            </ul>
                        </div>
                    </div>
                </section>

                <section>
                    <h3>Collections</h3>

                    <ul>
                        <li class="fragment">Collections ~= Tables</li>
                        <li class="fragment">Hold documents</li>
                        <li class="fragment">Can often be created automatically</li>
                        <li class="fragment">Indexable</li>
                        <li class="fragment">Validatable</li>
                    </ul>
                </section>

                <section>
                    <h3>Documents</h3>

                    <ul>
                        <li class="fragment">Documents are groups of key/value pairs</li>
                        <li class="fragment">Documents may be nested</li>
                        <li class="fragment">Highly compatible with objects</li>
                        <li class="fragment">BSON format</li>
                    </ul>
                </section>

                <section>
                    <h4>Document Example</h4>

                    <pre>
                        <code class="javascript" data-trim data-noescape data-line-numbers="1-19|2-4|5|6-8|9,11,12,13|14-18">
                            {
                                "_id": {
                                    "$oid": "573a13ebf29313caabdd043e"
                                },
                                "title": "What We Do in the Shadows",
                                "released": {
                                    "$date": "2015-02-13T00:00:00Z"
                                }
                                "genres": [ "Comedy", "Horror" ],
                                "rated": "R",
                                "cast": [ "Jemaine Clement", "Taika Waititi" /* , ... */ ],
                                "directors": [ "Jemaine Clement", "Taika Waititi" ],
                                "languages": [ "English", "German", "Spanish" ],
                                "imdb": {
                                    "rating": 7.6,
                                    "votes": 41029,
                                    "id": 3416742
                                }
                              }
                        </code>
                    </pre>
                </section>

                <section>
                    <h3>Flexible Schema</h3>

                    <ul>
                        <li class="fragment">Document structure matters</li>
                        <li class="fragment">...but can easily evolve as needs change</li>
                        <li class="fragment">Different and evolving structures may coexist</li>
                    </ul>
                </section>

                <section>
                    <h4>Flexible Schema Example</h4>

                    <pre>
                        <code class="javascript" data-trim data-noescape data-line-numbers>
                            [
                                {
                                    "_id": { "$oid": "573a13acf29313caabd289b3" },
                                    "title": "Anchorman: The Legend of Ron Burgundy",
                                    "year": 2004,
                                    "runtime": 94
                                },
                                {
                                    "_id": { "$oid": "573a13b1f29313caabd35ef4" },
                                    "title": "Talladega Nights: The Ballad of Ricky Bobby",
                                    "imdb_id": "tt0415306"
                                    "release_year": 2006
                                    "runtime_minutes": 108
                                  }
                            ]
                        </code>
                    </pre>
                </section>

                <section>
                    <h3>Relationships</h3>

                    <ul>
                        <li class="fragment">Embedded</li>
                        <li class="fragment">Reference</li>
                    </ul>
                </section>

                <section>
                    <h4>Relationship Example - Embedded</h4>

                    <div class="mermaid">
                        <pre>
                            %%{init: {'theme': 'default', 'themeVariables': { 'fontFamily': 'consolas' }}}%%
                            erDiagram
                                MOVIES {
                                    objectid _id PK
                                    string title
                                    array(string) cast
                                    array(string) directors
                                }
                        </pre>
                    </div>
                </section>

                <section>
                    <h4>Relationship Example - Reference</h4>

                    <div class="mermaid">
                        <pre>
                            %%{init: {'theme': 'default', 'themeVariables': { 'fontFamily': 'consolas' }}}%%
                            erDiagram
                                MOVIES ||--o{ COMMENTS : has
                                MOVIES {
                                    objectid _id PK
                                    string title
                                    int num_mflix_comments
                                }

                                COMMENTS {
                                    objectid _id PK
                                    objectid movie_id FK
                                    string name
                                    string email
                                    date date
                                    string text
                                }
                        </pre>
                    </div>
                </section>
            </section>

            <!--
# What I wish I knew about MongoDB Five Years Ago

* Tables & Rows -> Collections & Documents
* Schemaless -> Flexible Schema
* Non-relational -> All data is relational
* BSON
* Aggregation Pipelines (Continuously evolving)
* Document Patterns
    * Bucket Pattern
    * Polymorphic Pattern
    * Attribute Pattern
* Indexing
* Explain Plans
* Transactions (more recent v4.0)
            -->
        </div>
    </div>
</body>

</html>